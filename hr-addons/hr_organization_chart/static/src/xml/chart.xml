<templates xml:space="preserve">

    <t t-name="empView.buttons">
        <div class="btn-group" role="toolbar">
            <button class="btn btn-secondary fa fa-list-ol o_emp_button active" title="Levels" data-mode="levels"/>
            <button class="btn btn-secondary fa fa-sitemap o_emp_button" title="Managers" data-mode="managers"/>
            <button class="btn btn-secondary fa fa-building o_emp_button" title="Schema" data-mode="schema"/>
        </div>
    </t>

    <t t-name="org_chart">
        <t t-if="mode == 'levels'">
            <div class="tree tree-level">
                <t t-foreach="data" t-as="group">
                    <t t-call="chart-levels">
                        <t t-set="employees" t-value="group[1]"/>
                    </t>
                </t>
            </div>
        </t>
        <t t-elif="mode == 'managers'">
            <div class="tree">
                <t t-call="chart">
                    <t t-set="emp_tree" t-value="data"/>
                </t>
            </div>
        </t>
    </t>

    <t t-name="chart">
        <ul>
            <t t-foreach="emp_tree" t-as="employee">
                <li>
                    <a class="card" t-att-data-id="employee[0].id">
                        <img t-attf-src="data:image/*;base64,{{employee[0].image_1920}}"
                             width="50" height="50"
                             t-att-alt="employee[0].name"
                             class="o_media_object rounded-circle o_employee_redirect"/>
                        <h5 class="o_media_heading">
                            <b>
                                <t t-esc="employee[0].name"/>
                            </b>
                        </h5>
                        <strong>
                            <t t-esc="employee[0].job_title"/>
                        </strong>
                    </a>
                    <t t-if="employee[1][0]">
                        <t t-call="chart">
                            <t t-set="emp_tree" t-value="employee[1]"/>
                        </t>
                    </t>
                </li>
            </t>
        </ul>
    </t>

    <t t-name="chart-levels">
        <t t-if="employees">
            <h3>
                <t t-esc="employees[0].job_level"/>
            </h3>
        </t>
        <ul>
            <t t-foreach="employees" t-as="employee">
                <li>
                    <a class="card" t-att-data-id="employee.id">
                        <img t-attf-src="data:image/*;base64,{{employee.image_1920}}"
                             width="50" height="50"
                             t-att-alt="employee.name"
                             class="o_media_object rounded-circle o_employee_redirect"/>
                        <h5 class="o_media_heading">
                            <b>
                                <t t-esc="employee.name"/>
                            </b>
                        </h5>
                        <strong>
                            <t t-esc="employee.job_title"/>
                        </strong>
                    </a>
                </li>
            </t>
        </ul>
        <hr/>
    </t>

</templates>
