<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="hr_leave_view_form_inherit" model="ir.ui.view">
        <field name="name">hr.leave.tree.inherit</field>
        <field name="model">hr.leave</field>
        <field name="inherit_id" ref="hr_holidays.hr_leave_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='holiday_status_id']" position="before">
                <field name="leave_category" required="1"
                                                                  readonly="state != not in ['draft', 'confirm']"/>

<!--                       attrs="{'readonly': [('state', 'not in', ('draft', 'confirm'))]}"/>-->
            </xpath>
            <field name="holiday_status_id" position="attributes">
                <attribute name="domain">
                    [('category', '=', leave_category),'|', ('requires_allocation', '=', 'no'), '&amp;', ('has_valid_allocation', '=', True), '&amp;', ('virtual_remaining_leaves', '&gt;', 0), ('max_leaves', '>', '0')]
                </attribute>
            </field>
        </field>
    </record>

    <record id="hr_leave_view_form_manager_inherit" model="ir.ui.view">
        <field name="name">hr.leave.form.inherit</field>
        <field name="model">hr.leave</field>
        <field name="priority">99</field>
        <field name="inherit_id" ref="hr_holidays.hr_leave_view_form_manager"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='holiday_status_id']" position="before">
                <field name="leave_category" required="1" class="col-4"/><br/>
            </xpath>
            <field name="holiday_status_id" position="attributes">
                <attribute name="domain">
                    [('category', '=', leave_category)]
                </attribute>
            </field>
        </field>
    </record>


    <record id="view_hr_holidays_filter_inherit" model="ir.ui.view">
        <field name="name">hr.leave.filter.inherit</field>
        <field name="model">hr.leave</field>
        <field name="inherit_id" ref="hr_holidays.view_hr_holidays_filter"/>
        <field name="arch" type="xml">
            <field name="employee_id" position="after">
                <field name="leave_category"/>
            </field>
            <filter name="my_leaves" position="after">
                <separator/>
                <filter string="Holidays" name="leave_category_holidays"
                        domain="[('leave_category', '=', 'holiday')]"/>
            </filter>
        </field>
    </record>

</odoo>
