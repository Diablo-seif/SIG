<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="project_project_form" model="ir.ui.view">
        <field name="name">project.project.form</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="hr_timesheet.project_invoice_form" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='allocated_hours']" position="after">
                <field name="progress" widget="percentage" />
            </xpath>
            <xpath expr="//field[@name='allocated_hours']" position="attributes">
                <attribute name="widget"></attribute>
                <attribute name="string">Planned Effort</attribute>
            </xpath>
            <xpath expr="//page[@name='settings']" position="after">
                <page name="project_plan_line" string="Plan">
                    <field name="project_plan_line_ids">
                        <list decoration-danger="cumulative_target > actual_progress"
                            decoration-success="cumulative_target &lt;=  actual_progress"
                            editable="bottom" edit="1" default_order="end_date">
                            <field name="start_date" />
                            <field name="end_date" />
                            <field name="target" widget="percentage" />
                            <field name="cumulative_target" widget="percentage" />
                            <field name="actual_progress" widget="percentage" />
                        </list>
                    </field>
                    <group col="12" class="oe_invoice_lines_tab">
                        <group class="oe_subtotal_footer oe_right">
                            <field name="total_target_percentage" widget="percentage" />
                        </group>
                    </group>
                </page>
            </xpath>
            <xpath expr="//field[@name='tag_ids']" position="after">
                <field name="contract_received_planned_date" />
                <field name="site_handover_planned_date" />
                <field name="down_payment_received_planned_date" />
            </xpath>
            <xpath expr="//field[@name='progress']" position="after">
                <field name="contract_received_actual_date" />
                <field name="site_handover_actual_date" />
                <field name="down_payment_received_actual_date" />
            </xpath>
        </field>
    </record>

    <record id="inherit_edit_project_form" model="ir.ui.view">
        <field name="name">project.project.form</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.edit_project" />
        <field name="arch" type="xml">
            <field name="tag_ids" position="before">
                <field name="tag_id" required="1" />
            </field>
        </field>
    </record>

    <record id="project_project_view_pivot" model="ir.ui.view">
        <field name="name">project.project.view.pivot</field>
        <field name="model">project.project</field>
        <field name="arch" type="xml">
            <pivot>
                <field name="name" type="row" />
            </pivot>
        </field>
    </record>

    <record id="view_project_project_filter" model="ir.ui.view">
        <field name="name">inherit.project.project.search</field>
        <field name="model">project.project</field>
        <field name="inherit_id" ref="project.view_project_project_filter" />
        <field name="arch" type="xml">
            <filter name="groupby_stage" position="after">
                <filter string="Tag" name="group_by_tag_id" context="{'group_by':'tag_id'}" />
                <filter string="Start Date" name="group_by_date_start"
                    context="{'group_by':'date_start:year'}" />
            </filter>
        </field>
    </record>

    <record id="project.open_view_project_all_group_stage" model="ir.actions.act_window">
        <field name="view_mode">kanban,tree,form,gantt,calendar,activity,pivot</field>
        <field name="context">{
            'default_allow_billable': True,
            'search_default_group_by_tag_id': 1,
            'search_default_group_by_date_start': 1
            }</field>
    </record>
</odoo>